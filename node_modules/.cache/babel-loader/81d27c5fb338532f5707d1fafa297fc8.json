{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/sale1/Desktop/SHOPTIME/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/sale1/Desktop/SHOPTIME/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{setAlert}from'./alert';import{get_item_total}from'./cart';import{GET_PAYMENT_TOTAL_SUCCESS,GET_PAYMENT_TOTAL_FAIL,LOAD_BT_TOKEN_SUCCESS,LOAD_BT_TOKEN_FAIL,PAYMENT_SUCCESS,PAYMENT_FAIL,RESET_PAYMENT_INFO,SET_PAYMENT_LOADING,REMOVE_PAYMENT_LOADING}from'./types';export var get_payment_total=function get_payment_total(shipping_id,coupon_name){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:config={headers:{'Accept':'application/json','Authorization':\"JWT \".concat(localStorage.getItem('access'))}};_context.prev=1;_context.next=4;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/payment/get-payment-total?shipping_id=\").concat(shipping_id,\"&coupon_name=\").concat(coupon_name),config);case 4:res=_context.sent;if(res.status===200&&!res.data.error){dispatch({type:GET_PAYMENT_TOTAL_SUCCESS,payload:res.data});}else{dispatch({type:GET_PAYMENT_TOTAL_FAIL});}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:GET_PAYMENT_TOTAL_FAIL});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var get_client_token=function get_client_token(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:config={headers:{'Accept':'application/json','Authorization':\"JWT \".concat(localStorage.getItem('access'))}};_context2.prev=1;_context2.next=4;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/payment/get-token\"),config);case 4:res=_context2.sent;if(res.status===200){dispatch({type:LOAD_BT_TOKEN_SUCCESS,payload:res.data});}else{dispatch({type:LOAD_BT_TOKEN_FAIL});}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch({type:LOAD_BT_TOKEN_FAIL});case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var process_payment=function process_payment(nonce,shipping_id,coupon_name,full_name,address_line_1,address_line_2,city,state_province_region,postal_zip_code,country_region,telephone_number){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{'Accept':'application/json','Content-Type':'application/json','Authorization':\"JWT \".concat(localStorage.getItem('access'))}};body=JSON.stringify({nonce:nonce,shipping_id:shipping_id,coupon_name:coupon_name,full_name:full_name,address_line_1:address_line_1,address_line_2:address_line_2,city:city,state_province_region:state_province_region,postal_zip_code:postal_zip_code,country_region:country_region,telephone_number:telephone_number});dispatch({type:SET_PAYMENT_LOADING});_context3.prev=3;_context3.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/payment/make-payment\"),body,config);case 6:res=_context3.sent;if(res.status===200&&res.data.success){dispatch({type:PAYMENT_SUCCESS});dispatch(setAlert(res.data.success,'success'));dispatch(get_item_total());}else{dispatch({type:PAYMENT_FAIL});dispatch(setAlert(res.data.error,'danger'));}_context3.next=14;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](3);dispatch({type:PAYMENT_FAIL});dispatch(setAlert('Error processing payment','danger'));case 14:dispatch({type:REMOVE_PAYMENT_LOADING});window.scrollTo(0,0);case 16:case\"end\":return _context3.stop();}}},_callee3,null,[[3,10]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var reset=function reset(){return function(dispatch){dispatch({type:RESET_PAYMENT_INFO});};};","map":{"version":3,"sources":["C:/Users/sale1/Desktop/SHOPTIME/src/actions/payment.js"],"names":["axios","setAlert","get_item_total","GET_PAYMENT_TOTAL_SUCCESS","GET_PAYMENT_TOTAL_FAIL","LOAD_BT_TOKEN_SUCCESS","LOAD_BT_TOKEN_FAIL","PAYMENT_SUCCESS","PAYMENT_FAIL","RESET_PAYMENT_INFO","SET_PAYMENT_LOADING","REMOVE_PAYMENT_LOADING","get_payment_total","shipping_id","coupon_name","dispatch","config","headers","localStorage","getItem","get","process","env","REACT_APP_API_URL","res","status","data","error","type","payload","get_client_token","process_payment","nonce","full_name","address_line_1","address_line_2","city","state_province_region","postal_zip_code","country_region","telephone_number","body","JSON","stringify","post","success","window","scrollTo","reset"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport { setAlert } from './alert';\r\nimport { get_item_total } from './cart';\r\nimport {\r\n    GET_PAYMENT_TOTAL_SUCCESS,\r\n    GET_PAYMENT_TOTAL_FAIL,\r\n    LOAD_BT_TOKEN_SUCCESS,\r\n    LOAD_BT_TOKEN_FAIL,\r\n    PAYMENT_SUCCESS,\r\n    PAYMENT_FAIL,\r\n    RESET_PAYMENT_INFO,\r\n    SET_PAYMENT_LOADING,\r\n    REMOVE_PAYMENT_LOADING\r\n} from './types';\r\n\r\nexport const get_payment_total = (shipping_id, coupon_name) => async dispatch => {\r\n    const config = {\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Authorization': `JWT ${localStorage.getItem('access')}`\r\n        }\r\n    };\r\n\r\n    try {\r\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/api/payment/get-payment-total?shipping_id=${shipping_id}&coupon_name=${coupon_name}`, config);\r\n\r\n        if (res.status === 200 && !res.data.error) {\r\n            dispatch({\r\n                type: GET_PAYMENT_TOTAL_SUCCESS,\r\n                payload: res.data\r\n            });\r\n        } else {\r\n            dispatch({\r\n                type: GET_PAYMENT_TOTAL_FAIL\r\n            });\r\n        }\r\n    } catch(err) {\r\n        dispatch({\r\n            type: GET_PAYMENT_TOTAL_FAIL\r\n        });\r\n    }\r\n};\r\n\r\nexport const get_client_token = () => async dispatch => {\r\n    const config = {\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Authorization': `JWT ${localStorage.getItem('access')}`\r\n        }\r\n    };\r\n\r\n    try {\r\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/api/payment/get-token`, config);\r\n\r\n        if (res.status === 200) {\r\n            dispatch({\r\n                type: LOAD_BT_TOKEN_SUCCESS,\r\n                payload: res.data\r\n            });\r\n        } else {\r\n            dispatch({\r\n                type: LOAD_BT_TOKEN_FAIL\r\n            });\r\n        }\r\n    } catch(err) {\r\n        dispatch({\r\n            type: LOAD_BT_TOKEN_FAIL\r\n        });\r\n    }\r\n};\r\n\r\nexport const process_payment = (\r\n    nonce,\r\n    shipping_id,\r\n    coupon_name,\r\n    full_name,\r\n    address_line_1,\r\n    address_line_2,\r\n    city,\r\n    state_province_region,\r\n    postal_zip_code,\r\n    country_region,\r\n    telephone_number\r\n) => async dispatch => {\r\n    const config = {\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `JWT ${localStorage.getItem('access')}`\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({\r\n        nonce,\r\n        shipping_id,\r\n        coupon_name,\r\n        full_name,\r\n        address_line_1,\r\n        address_line_2,\r\n        city,\r\n        state_province_region,\r\n        postal_zip_code,\r\n        country_region,\r\n        telephone_number\r\n    });\r\n\r\n    dispatch({\r\n        type: SET_PAYMENT_LOADING\r\n    });\r\n\r\n    try {\r\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/api/payment/make-payment`, body, config);\r\n\r\n        if (res.status === 200 && res.data.success) {\r\n            dispatch({\r\n                type: PAYMENT_SUCCESS\r\n            });\r\n            dispatch(setAlert(res.data.success, 'success'));\r\n            dispatch(get_item_total());\r\n        } else {\r\n            dispatch({\r\n                type: PAYMENT_FAIL\r\n            });\r\n            dispatch(setAlert(res.data.error, 'danger'));\r\n        }\r\n    } catch(err) {\r\n        dispatch({\r\n            type: PAYMENT_FAIL\r\n        });\r\n        dispatch(setAlert('Error processing payment', 'danger'));\r\n    }\r\n\r\n    dispatch({\r\n        type: REMOVE_PAYMENT_LOADING\r\n    });\r\n    window.scrollTo(0, 0);\r\n};\r\n\r\nexport const reset = () => dispatch => {\r\n    dispatch({\r\n        type: RESET_PAYMENT_INFO\r\n    });\r\n};"]},"metadata":{},"sourceType":"module"}