{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/sale1/Desktop/SHOPTIME/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/sale1/Desktop/SHOPTIME/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import{combineReducers}from'redux';import{setAlert}from'./alert';import{SIGNUP_SUCCESS,SIGNUP_FAIL,LOGIN_SUCCESS,LOGIN_FAIL,GOOGLE_AUTH_SUCCESS,GOOGLE_AUTH_FAIL,AUTHENTICATED_SUCCESS,AUTHENTICATED_FAIL,RESET_PASSWORD_SUCCESS,RESET_PASSWORD_FAIL,RESET_PASSWORD_CONFIRM_SUCCESS,RESET_PASSWORD_CONFIRM_FAIL,REFRESH_SUCCESS,REFRESH_FAIL,SET_AUTH_LOADING,REMOVE_AUTH_LOADING,ACTIVATION_SUCCESS,ACTIVATION_FAIL,USER_LOADED_SUCCESS,USER_LOADED_FAIL,LOGOUT}from'./types';export var check_authenticated=function check_authenticated(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!localStorage.getItem('access')){_context.next=15;break;}config={headers:{'Accept':'application/json','Content-Type':'application/json'}};body=JSON.stringify({token:localStorage.getItem('access')});_context.prev=3;_context.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/verify/\"),body,config);case 6:res=_context.sent;if(res.data.code!=='token_not_valid'){dispatch({type:AUTHENTICATED_SUCCESS});}else{dispatch({type:AUTHENTICATED_FAIL});}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);dispatch({type:AUTHENTICATED_FAIL});case 13:_context.next=16;break;case 15:dispatch({type:AUTHENTICATED_FAIL});case 16:case\"end\":return _context.stop();}}},_callee,null,[[3,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var signup=function signup(first_name,last_name,email,password,re_password){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({first_name:first_name,last_name:last_name,email:email,password:password,re_password:re_password});_context2.prev=3;_context2.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/\"),body,config);case 6:res=_context2.sent;if(res.data.email){dispatch({type:SIGNUP_SUCCESS,payload:res.data});dispatch(setAlert('We sent you an email, please activate your account','success'));}else{dispatch({type:SIGNUP_FAIL});dispatch(setAlert('Error creating account','danger'));}dispatch({type:REMOVE_AUTH_LOADING});_context2.next=16;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](3);dispatch({type:SIGNUP_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error creating account','danger'));case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[3,11]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var load_user=function load_user(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!localStorage.getItem('access')){_context3.next=14;break;}config={headers:{'Authorization':\"JWT \".concat(localStorage.getItem('access')),'Accept':'application/json'}};_context3.prev=2;_context3.next=5;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/me\"),config);case 5:res=_context3.sent;if(res.data.email){dispatch({type:USER_LOADED_SUCCESS,payload:res.data});}else{dispatch({type:USER_LOADED_FAIL});}_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](2);dispatch({type:USER_LOADED_FAIL});case 12:_context3.next=15;break;case 14:dispatch({type:USER_LOADED_FAIL});case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[2,9]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var login=function login(email,password){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email,password:password});_context4.prev=3;_context4.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/create/\"),body,config);case 6:res=_context4.sent;if(res.data.access){dispatch({type:LOGIN_SUCCESS,payload:res.data});dispatch(load_user());dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Logged in successfully','success'));}else{dispatch({type:LOGIN_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error authenticating','danger'));}_context4.next=15;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](3);dispatch({type:LOGIN_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error authenticating','danger'));case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[3,10]]);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var google_authenticate=function google_authenticate(state,code){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var config,details,formBody,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(state&&code&&!localStorage.getItem('access'))){_context5.next=17;break;}dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/x-www-form-urlencoded'}};details={'state':state,'code':code};formBody=Object.keys(details).map(function(key){return encodeURIComponent(key)+'+'+encodeURIComponent(details[key]);}).join('&');_context5.prev=5;_context5.next=8;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/o/google-oauth2/?\").concat(formBody),config);case 8:res=_context5.sent;if(res.data.access){dispatch({type:GOOGLE_AUTH_SUCCESS,payload:res.data});dispatch(load_user());dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Logged in successfully','success'));}else{dispatch({type:GOOGLE_AUTH_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error authenticating','danger'));}_context5.next=17;break;case 12:_context5.prev=12;_context5.t0=_context5[\"catch\"](5);dispatch({type:GOOGLE_AUTH_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error authenticating','danger'));case 17:case\"end\":return _context5.stop();}}},_callee5,null,[[5,12]]);}));return function(_x5){return _ref5.apply(this,arguments);};}();};export var activate=function activate(uid,token){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({uid:uid,token:token});_context6.prev=3;_context6.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/activation/\"),body,config);case 6:res=_context6.sent;if(res.data.uid||res.data.token){dispatch({type:ACTIVATION_FAIL});dispatch(setAlert('Error activating account','danger'));}else{dispatch({type:ACTIVATION_SUCCESS});dispatch(setAlert('Successfully activated your account','success'));}dispatch({type:REMOVE_AUTH_LOADING});_context6.next=16;break;case 11:_context6.prev=11;_context6.t0=_context6[\"catch\"](3);dispatch({type:ACTIVATION_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error creating account','danger'));case 16:case\"end\":return _context6.stop();}}},_callee6,null,[[3,11]]);}));return function(_x6){return _ref6.apply(this,arguments);};}();};export var refresh=function refresh(){return/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){var config,body,res;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(!localStorage.getItem('refresh')){_context7.next=15;break;}config={headers:{'Accept':'application/json','Content':'application/json'}};body=JSON.stringify({refresh:localStorage.getItem('refresh')});_context7.prev=3;_context7.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/refresh\"),body,config);case 6:res=_context7.sent;if(res.data.access){dispatch({type:REFRESH_SUCCESS,payload:res.data});}else{dispatch({type:REFRESH_FAIL});}_context7.next=13;break;case 10:_context7.prev=10;_context7.t0=_context7[\"catch\"](3);dispatch({type:REFRESH_FAIL});case 13:_context7.next=16;break;case 15:dispatch({type:REFRESH_FAIL});case 16:case\"end\":return _context7.stop();}}},_callee7,null,[[3,10]]);}));return function(_x7){return _ref7.apply(this,arguments);};}();};export var reset_password=function reset_password(email){return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(dispatch){var config,body;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({email:email});_context8.prev=3;_context8.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/reset_password/\"),body,config);case 6:dispatch({type:RESET_PASSWORD_SUCCESS});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Password reset email sent','success'));_context8.next=16;break;case 11:_context8.prev=11;_context8.t0=_context8[\"catch\"](3);dispatch({type:RESET_PASSWORD_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error sending password reset email','danger'));case 16:case\"end\":return _context8.stop();}}},_callee8,null,[[3,11]]);}));return function(_x8){return _ref8.apply(this,arguments);};}();};export var reset_password_confirm=function reset_password_confirm(uid,token,new_password,re_new_password){return/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(dispatch){var config,body;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:dispatch({type:SET_AUTH_LOADING});config={headers:{'Content-Type':'application/json'}};body=JSON.stringify({uid:uid,token:token,new_password:new_password,re_new_password:re_new_password});if(!(new_password!==re_new_password)){_context9.next=9;break;}dispatch({type:RESET_PASSWORD_CONFIRM_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Passwords do not match','danger'));_context9.next=22;break;case 9:_context9.prev=9;_context9.next=12;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/reset_password_confirm/\"),body,config);case 12:dispatch({type:RESET_PASSWORD_CONFIRM_SUCCESS});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Password has been reset successfully','success'));_context9.next=22;break;case 17:_context9.prev=17;_context9.t0=_context9[\"catch\"](9);dispatch({type:RESET_PASSWORD_CONFIRM_FAIL});dispatch({type:REMOVE_AUTH_LOADING});dispatch(setAlert('Error resetting your password','danger'));case 22:case\"end\":return _context9.stop();}}},_callee9,null,[[9,17]]);}));return function(_x9){return _ref9.apply(this,arguments);};}();};export var logout=function logout(){return function(dispatch){dispatch({type:LOGOUT});dispatch(setAlert('Logout Out','success'));};};","map":{"version":3,"sources":["C:/Users/sale1/Desktop/SHOPTIME/frontend/src/actions/auth.js"],"names":["axios","combineReducers","setAlert","SIGNUP_SUCCESS","SIGNUP_FAIL","LOGIN_SUCCESS","LOGIN_FAIL","GOOGLE_AUTH_SUCCESS","GOOGLE_AUTH_FAIL","AUTHENTICATED_SUCCESS","AUTHENTICATED_FAIL","RESET_PASSWORD_SUCCESS","RESET_PASSWORD_FAIL","RESET_PASSWORD_CONFIRM_SUCCESS","RESET_PASSWORD_CONFIRM_FAIL","REFRESH_SUCCESS","REFRESH_FAIL","SET_AUTH_LOADING","REMOVE_AUTH_LOADING","ACTIVATION_SUCCESS","ACTIVATION_FAIL","USER_LOADED_SUCCESS","USER_LOADED_FAIL","LOGOUT","check_authenticated","dispatch","localStorage","getItem","config","headers","body","JSON","stringify","token","post","process","env","REACT_APP_API_URL","res","data","code","type","signup","first_name","last_name","email","password","re_password","payload","load_user","get","login","access","google_authenticate","state","details","formBody","Object","keys","map","key","encodeURIComponent","join","activate","uid","refresh","reset_password","reset_password_confirm","new_password","re_new_password","logout"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport { combineReducers } from 'redux';\r\nimport { setAlert } from './alert';\r\nimport {\r\n    SIGNUP_SUCCESS,\r\n    SIGNUP_FAIL,\r\n    LOGIN_SUCCESS,\r\n    LOGIN_FAIL,\r\n    GOOGLE_AUTH_SUCCESS,\r\n    GOOGLE_AUTH_FAIL,\r\n    AUTHENTICATED_SUCCESS,\r\n    AUTHENTICATED_FAIL,\r\n    RESET_PASSWORD_SUCCESS,\r\n    RESET_PASSWORD_FAIL,\r\n    RESET_PASSWORD_CONFIRM_SUCCESS,\r\n    RESET_PASSWORD_CONFIRM_FAIL,\r\n    REFRESH_SUCCESS,\r\n    REFRESH_FAIL,\r\n    SET_AUTH_LOADING,\r\n    REMOVE_AUTH_LOADING,\r\n    ACTIVATION_SUCCESS,\r\n    ACTIVATION_FAIL,\r\n    USER_LOADED_SUCCESS,\r\n    USER_LOADED_FAIL,\r\n    LOGOUT,\r\n} from './types';\r\n\r\nexport const check_authenticated = () => async dispatch => {\r\n    if (localStorage.getItem('access')) {\r\n        const config = {\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n            }\r\n        };\r\n\r\n        const body = JSON.stringify({\r\n            token: localStorage.getItem('access')\r\n        });\r\n\r\n        try {\r\n            const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/verify/`, body, config);\r\n\r\n            if (res.data.code !== 'token_not_valid') {\r\n                dispatch({\r\n                    type: AUTHENTICATED_SUCCESS\r\n                });\r\n            } else {\r\n                dispatch({\r\n                    type: AUTHENTICATED_FAIL\r\n                });\r\n            }\r\n        } catch (err) {\r\n            dispatch({\r\n                type: AUTHENTICATED_FAIL\r\n            });\r\n        }\r\n    } else {\r\n        dispatch({\r\n            type: AUTHENTICATED_FAIL\r\n        });\r\n    }\r\n};\r\n\r\nexport const signup = (first_name, last_name, email, password, re_password) => async dispatch => {\r\n    dispatch({\r\n        type: SET_AUTH_LOADING\r\n    });\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({\r\n        first_name,\r\n        last_name,\r\n        email,\r\n        password,\r\n        re_password,\r\n    });\r\n\r\n    try {\r\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/`, body, config);\r\n\r\n        if (res.data.email) {\r\n            dispatch({\r\n                type: SIGNUP_SUCCESS,\r\n                payload: res.data\r\n            });\r\n            dispatch(setAlert('We sent you an email, please activate your account', 'success'));\r\n        } else {\r\n            dispatch({\r\n                type: SIGNUP_FAIL\r\n            });\r\n            dispatch(setAlert('Error creating account', 'danger'));\r\n        }\r\n        dispatch({\r\n            type: REMOVE_AUTH_LOADING\r\n        });\r\n    } catch (err) {\r\n        dispatch({\r\n            type: SIGNUP_FAIL\r\n        });\r\n        dispatch({\r\n            type: REMOVE_AUTH_LOADING\r\n        });\r\n        dispatch(setAlert('Error creating account', 'danger'));\r\n    }\r\n};\r\n\r\nexport const load_user = () => async dispatch => {\r\n    if (localStorage.getItem('access')) {\r\n        const config = {\r\n            headers: {\r\n                'Authorization': `JWT ${localStorage.getItem('access')}`,\r\n                'Accept': 'application/json'\r\n            }\r\n        };\r\n\r\n        try {\r\n            const res = await axios.get(`${process.env.REACT_APP_API_URL}/auth/users/me`, config);\r\n            if (res.data.email) {\r\n                dispatch({\r\n                    type: USER_LOADED_SUCCESS,\r\n                    payload: res.data\r\n                });\r\n            } else {\r\n                dispatch({\r\n                    type: USER_LOADED_FAIL\r\n                });\r\n            }\r\n        } catch (err) {\r\n            dispatch({\r\n                type: USER_LOADED_FAIL\r\n            });\r\n        }\r\n    } else {\r\n        dispatch({\r\n            type: USER_LOADED_FAIL\r\n        });\r\n    }\r\n};\r\n\r\n\r\nexport const login = (email, password) => async dispatch => {\r\n    dispatch({\r\n        type: SET_AUTH_LOADING\r\n    });\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({\r\n        email,\r\n        password\r\n    });\r\n\r\n    try {\r\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/create/`, body, config);\r\n\r\n        if (res.data.access) {\r\n            dispatch({\r\n                type: LOGIN_SUCCESS,\r\n                payload: res.data\r\n            });\r\n            dispatch(load_user());\r\n            dispatch({\r\n                type: REMOVE_AUTH_LOADING\r\n            });\r\n            dispatch(setAlert('Logged in successfully', 'success'));\r\n        } else {\r\n            dispatch({\r\n                type: LOGIN_FAIL,\r\n            });\r\n            dispatch({\r\n                type: REMOVE_AUTH_LOADING\r\n            });\r\n            dispatch(setAlert('Error authenticating', 'danger'));\r\n        }\r\n    } catch (err) {\r\n        dispatch({\r\n            type: LOGIN_FAIL\r\n        });\r\n        dispatch({\r\n            type: REMOVE_AUTH_LOADING\r\n        });\r\n        dispatch(setAlert('Error authenticating', 'danger'));\r\n\r\n    }\r\n};\r\n\r\nexport const google_authenticate = (state, code) => async dispatch => {\r\n    if (state && code && !localStorage.getItem('access')) {\r\n        dispatch({\r\n            type: SET_AUTH_LOADING\r\n        });\r\n\r\n        const config = {\r\n            headers: {\r\n                'Content-Type': 'application/x-www-form-urlencoded'\r\n            }\r\n        };\r\n\r\n        const details = {\r\n            'state': state,\r\n            'code': code\r\n        };\r\n\r\n        const formBody = Object.keys(details).map(key => encodeURIComponent(key) + '+' + encodeURIComponent(details[key])).join('&');\r\n\r\n        try {\r\n            const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/o/google-oauth2/?${formBody}`, config );\r\n\r\n            if (res.data.access) {\r\n                dispatch({\r\n                    type: GOOGLE_AUTH_SUCCESS,\r\n                    payload: res.data\r\n                });\r\n                dispatch(load_user());\r\n                dispatch({\r\n                    type: REMOVE_AUTH_LOADING\r\n                });\r\n                dispatch(setAlert('Logged in successfully', 'success'));\r\n            } else {\r\n                dispatch({\r\n                    type: GOOGLE_AUTH_FAIL\r\n                });\r\n                dispatch({\r\n                    type: REMOVE_AUTH_LOADING\r\n                });\r\n                dispatch(setAlert('Error authenticating', 'danger'));\r\n            }\r\n        } catch (err) {\r\n            dispatch({\r\n                type: GOOGLE_AUTH_FAIL\r\n            });\r\n            dispatch({\r\n                type: REMOVE_AUTH_LOADING\r\n            });\r\n            dispatch(setAlert('Error authenticating', 'danger'));\r\n        }\r\n    }\r\n};\r\nexport const activate = (uid, token) => async dispatch => {\r\n    dispatch ({\r\n        type: SET_AUTH_LOADING\r\n    });\r\n\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({\r\n        uid,\r\n        token\r\n    });\r\n\r\n    try {\r\n        const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/activation/`, body, config)\r\n\r\n        if (res.data.uid || res.data.token) {\r\n            dispatch ({\r\n                type: ACTIVATION_FAIL\r\n            });\r\n            dispatch(setAlert('Error activating account', 'danger'));\r\n        } else {\r\n            dispatch({\r\n                type: ACTIVATION_SUCCESS\r\n            });\r\n            dispatch(setAlert('Successfully activated your account', 'success'));\r\n        }\r\n        dispatch({\r\n            type: REMOVE_AUTH_LOADING\r\n        });\r\n    } catch (err) {\r\n        dispatch({\r\n            type: ACTIVATION_FAIL\r\n        });\r\n        dispatch({\r\n            type: REMOVE_AUTH_LOADING\r\n        });\r\n        dispatch(setAlert('Error creating account', 'danger'));\r\n    }\r\n};\r\n\r\nexport const refresh = () => async dispatch => {\r\n    if (localStorage.getItem('refresh')) {\r\n        const config = {\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content': 'application/json'\r\n            }\r\n        };\r\n\r\n        const body = JSON.stringify({\r\n            refresh: localStorage.getItem('refresh')\r\n        });\r\n\r\n        try {\r\n            const res = await axios.post(`${process.env.REACT_APP_API_URL}/auth/jwt/refresh`, body, config);\r\n\r\n            if (res.data.access) {\r\n                dispatch({\r\n                    type: REFRESH_SUCCESS,\r\n                    payload: res.data\r\n                });\r\n            } else {\r\n                dispatch({\r\n                    type: REFRESH_FAIL\r\n                });\r\n            }\r\n        } catch (err) {\r\n            dispatch({\r\n                type: REFRESH_FAIL\r\n            });\r\n        }\r\n    } else {\r\n        dispatch({\r\n            type: REFRESH_FAIL\r\n        });\r\n    }\r\n};\r\n\r\nexport const reset_password = (email) => async dispatch => {\r\n    dispatch({\r\n        type: SET_AUTH_LOADING\r\n    });\r\n\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({ email });\r\n\r\n    try {\r\n        await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/reset_password/`, body, config);\r\n\r\n        dispatch({\r\n            type: RESET_PASSWORD_SUCCESS\r\n        });\r\n        dispatch({\r\n            type: REMOVE_AUTH_LOADING\r\n        });\r\n        dispatch(setAlert('Password reset email sent', 'success'));\r\n    } catch (err) {\r\n        dispatch({\r\n            type: RESET_PASSWORD_FAIL\r\n        });\r\n        dispatch({\r\n            type: REMOVE_AUTH_LOADING\r\n        });\r\n        dispatch(setAlert('Error sending password reset email', 'danger'));\r\n    }\r\n};\r\n\r\nexport const reset_password_confirm = (uid, token, new_password, re_new_password) => async dispatch => {\r\n    dispatch({\r\n        type: SET_AUTH_LOADING\r\n    });\r\n\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        }\r\n    };\r\n\r\n    const body = JSON.stringify({\r\n        uid,\r\n        token,\r\n        new_password,\r\n        re_new_password\r\n    });\r\n\r\n    if (new_password !== re_new_password) {\r\n        dispatch({\r\n            type: RESET_PASSWORD_CONFIRM_FAIL\r\n        });\r\n        dispatch({\r\n            type: REMOVE_AUTH_LOADING\r\n        });\r\n        dispatch(setAlert('Passwords do not match', 'danger'));\r\n    } else {\r\n        try {\r\n            await axios.post(`${process.env.REACT_APP_API_URL}/auth/users/reset_password_confirm/`, body, config);\r\n\r\n            dispatch({\r\n                type: RESET_PASSWORD_CONFIRM_SUCCESS\r\n            });\r\n            dispatch({\r\n                type: REMOVE_AUTH_LOADING\r\n            });\r\n            dispatch(setAlert('Password has been reset successfully', 'success'));\r\n        } catch (err) {\r\n            dispatch({\r\n                type: RESET_PASSWORD_CONFIRM_FAIL\r\n            });\r\n            dispatch({\r\n                type: REMOVE_AUTH_LOADING\r\n            });\r\n            dispatch(setAlert('Error resetting your password', 'danger'));\r\n        }\r\n    }\r\n};\r\n\r\nexport const logout = () => dispatch => {\r\n    dispatch({\r\n        type: LOGOUT\r\n    });\r\n    dispatch(setAlert('Logout Out', 'success'));\r\n};"]},"metadata":{},"sourceType":"module"}